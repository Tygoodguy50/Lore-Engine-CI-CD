# Bazel configuration for LocalAI

# Disable CGO by default to avoid C++ toolchain issues
build --action_env=CGO_ENABLED=0

# Use pure Go builds
build --platforms=@rules_go//go/toolchain:linux_amd64
build --platforms=@rules_go//go/toolchain:darwin_amd64
build --platforms=@rules_go//go/toolchain:windows_amd64

# Enable Bzlmod
common --enable_bzlmod

# Improve build performance
build --jobs=auto
build --local_ram_resources=HOST_RAM*0.75
build --local_cpu_resources=HOST_CPUS*0.75

# Show detailed error messages
build --verbose_failures

# Use Go toolchain from rules_go
build --incompatible_enable_cc_toolchain_resolution
